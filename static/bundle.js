!function e(t,n,r){function a(i,c){if(!n[i]){if(!t[i]){var o="function"==typeof require&&require;if(!c&&o)return o(i,!0);if(s)return s(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){var n=t[i][1][e];return a(n?n:e)},u,u.exports,e,t,n,r)}return n[i].exports}for(var s="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t,n){var r=e("./deployment_dialog.jsx"),a=e("./create_project_progress.jsx"),s=document.getElementById("deployment-dialog-holder");s&&React.render(React.createElement(r,{context:environmentConfigContext}),s);var i=document.getElementById("create-project-progress-holder");i&&React.render(React.createElement(a,{statusUrl:createProjectStatusUrl,deployKey:deployKey,deployKeyTestUrl:deployKeyTestUrl,initalCanAccessRepo:canAccessRepo}),i)},{"./create_project_progress.jsx":2,"./deployment_dialog.jsx":5}],2:[function(e,t,n){var r=e("underscore"),a=e("./deploy_key_test.jsx"),s=React.createClass({displayName:"CreateProjectProgress",checkInterval:!1,getInitialState:function(){return{complete:!1,checkingStatus:!1,progress:{environments:{complete:[],inProgress:[],failed:[]}}}},componentDidMount:function(){this.checkInterval=window.setInterval(this.handleCheckStatus,1e4)},componentWillUnmount:function(){this.checkInterval!==!1&&window.clearInterval(this.checkInterval)},handleCheckStatus:function(){this.state.checkingStatus||this.checkStatus()},checkStatus:function(){var e=this;$.ajax({url:this.props.statusUrl,dataType:"json",cache:!1,type:"GET",success:function(t){t.complete&&(e.setState({complete:!0}),window.clearInterval(this.checkInterval)),e.setState({checkingStatus:!1,progress:t.progress})}.bind(this),error:function(t,n,r){e.setState({checkingStatus:!1})}.bind(this)})},reload:function(e){e.preventDefault(),window.location.reload()},render:function(){if(!this.state.complete)var e=React.createElement(a,{deployKey:this.props.deployKey,initialCanAccessRepo:this.props.canAccessRepo,deployKeyTestUrl:this.props.deployKeyTestUrl});if(this.state.complete){var t=Object.keys(this.state.progress.environments.complete).length;if(0==t)var n="Go to stack overview";else var n="Take me to my environments!";var s=React.createElement("div",{className:"col-md-12"},React.createElement("p",null,React.createElement("a",{href:window.location.href,onClick:this.reload,className:"btn btn-primary"},n))),i=Object.keys(this.state.progress.environments.failed).length;if(i>0)var c=r.map(this.state.progress.environments.failed,function(e){return React.createElement("li",null,e)}),o=React.createElement("div",null,React.createElement("i",{className:"fa fa-exclamation fa-5x text-danger"}),React.createElement("h1",null,"Uh Oh!"),React.createElement("p",null,"Something went wrong and we had trouble creating your environments."),React.createElement("p",null,"Below is a list of environments which failed to build:"),React.createElement("div",{className:"col-md-6 col-md-offset-3 text-left"},React.createElement("div",{className:"alert alert-danger failed-environments"},React.createElement("ul",null,c))),s);else var o=React.createElement("div",null,React.createElement("i",{className:"fa fa-check text-success fa-5x"}),React.createElement("h1",null,"We're done!"),React.createElement("p",null,"Your environments are setup and ready to go!"),s);return React.createElement("div",{className:"row"},o)}return React.createElement("div",{className:"row"},React.createElement("div",{className:"row progress-icon"},React.createElement("i",{className:"fa fa-cog fa-spin fa-5x"})),React.createElement("h1",null,"Your environments are on their way!"),React.createElement("p",null,"We're currently building your environments which can take 15-45 minutes, depending on current traffic."),e)}});t.exports=s},{"./deploy_key_test.jsx":3,underscore:9}],3:[function(e,t,n){var r=React.createClass({displayName:"DeployKeyTest",getInitialState:function(){return{loading:!1,tested:!1,canAccessRepo:this.props.initialCanAccessRepo}},render:function(){return React.createElement("div",{className:"add-deploy-key"},React.createElement("h2",null,"Add your deploy key..."),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6 col-md-offset-3"},React.createElement("p",null,"To give us access to your private repositories you will need to add the deploy key below. How you add this will differ depending on what platform you host your GIT repository on:"),React.createElement("ul",{className:"list-inline"},React.createElement("li",null,React.createElement("i",{className:"fa fa-github"})," ",React.createElement("a",{href:"https://developer.github.com/guides/managing-deploy-keys/#deploy-keys",target:"_blank"},"Github")),React.createElement("li",null,React.createElement("i",{className:"fa fa-bitbucket"})," ",React.createElement("a",{href:"https://confluence.atlassian.com/bitbucket/use-deployment-keys-294486051.html",target:"_blank"},"Bitbucket")),React.createElement("li",null,React.createElement("img",{src:"deploynaut/img/gitlab.png",alt:"Gitlab",className:"gitlab-icon"})," ",React.createElement("a",{href:"http://doc.gitlab.com/ce/ssh/README.html#deploy-keys",target:"_blank"},"Gitlab"))))),React.createElement("div",{className:"col-md-8 col-md-offset-2 text-left",id:"deploy-key-test-holder"},React.createElement("pre",{className:"deploy-key"},this.props.deployKey)),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-8 col-md-offset-2"},this.button())))},testAccess:function(){this.setState({loading:!0});var e=this;$.ajax({url:this.props.deployKeyTestUrl,dataType:"json",cache:!1,type:"GET",success:function(t){e.setState({loading:!1,tested:!0,canAccessRepo:t.canAccessRepo})}.bind(this),error:function(t,n,r){e.setState({loading:!1,tested:!0,canAccesRepo:!1})}.bind(this)})},handleTestAccess:function(e){e.preventDefault(),this.testAccess()},button:function(){var e={__html:"Test Access"},t=!1,n="btn btn-primary";this.state.loading?(e={__html:'<i class="fa fa-cog fa-spin"></i> Attempting to clone repository...'},t=!0):this.state.canAccessRepo&&(e={__html:'<i class="fa fa-check"></i> We can access your repository'},t=!0,n="btn btn-success");var r;!this.state.tested||this.state.canAccessRepo||this.state.loading||(r=React.createElement("p",{className:"alert alert-danger"},"We're having trouble accessing your repository."));var a=React.createElement("button",{href:"#",className:n,onClick:this.handleTestAccess,disabled:t,dangerouslySetInnerHTML:e});return React.createElement("div",null,r,a)}});t.exports=r},{}],4:[function(e,t,n){var r=e("./events.js"),a=e("./helpers.js"),s=e("./summary_table.jsx"),i=React.createClass({displayName:"DeployPlan",loadingSub:null,loadingDoneSub:null,getInitialState:function(){return{loading_changes:!1,deploy_disabled:!1,deployHover:!1}},componentDidMount:function(){var e=this;this.loadingSub=r.subscribe("change_loading",function(){e.setState({loading_changes:!0})}),this.loadingDoneSub=r.subscribe("change_loading/done",function(){e.setState({loading_changes:!1})})},deployHandler:function(e){e.preventDefault(),this.setState({deploy_disabled:!0}),Q($.ajax({type:"POST",dataType:"json",url:this.props.context.envUrl+"/start-deploy",data:{strategy:this.props.summary,SecurityID:this.props.summary.SecurityID}})).then(function(e){window.location=e.url},function(e){console.error(e)})},mouseEnterHandler:function(e){this.setState({deployHover:!0})},mouseLeaveHandler:function(e){this.setState({deployHover:!1})},canDeploy:function(){return"success"===this.props.summary.validationCode||"warning"===this.props.summary.validationCode},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0},showNoChangesMessage:function(){var e=this.props.summary;return e.initialState===!0?!1:"undefined"===e.messages?!0:this.isEmpty(e.changes)&&0===e.messages.length},actionTitle:function(){var e=this.props.summary.actionTitle;return"undefined"==typeof e||""===e?"Make a selection":this.props.summary.actionTitle},render:function(){var e=this.props.summary.messages;this.showNoChangesMessage()&&(e=[{text:"There are no changes but you can deploy anyway if you wish.",code:"success"}]);var t;this.canDeploy()&&(t=React.createElement("div",{className:"section",onMouseEnter:this.mouseEnterHandler,onMouseLeave:this.mouseLeaveHandler},React.createElement("button",{value:"Confirm Deployment",className:"deploy pull-left",disabled:this.state.deploy_disabled,onClick:this.deployHandler},this.actionTitle()),React.createElement(c,{activated:this.state.deployHover,context:this.props.context,summary:this.props.summary})));var n=a.classNames({header:!0,inactive:!this.canDeploy(),loading:this.state.loading_changes});return React.createElement("div",null,React.createElement("div",{className:"section"},React.createElement("div",{className:n},React.createElement("span",{className:"status-icon"}),React.createElement("span",{className:"numberCircle"},"2")," Review changes"),React.createElement(o,{messages:e}),React.createElement(s,{changes:this.props.summary.changes})),t)}}),c=React.createClass({displayName:"QuickSummary",render:function(){var e="fast"===this.props.summary.actionCode?"code-only":"full",t=[];this.props.summary.estimatedTime&&this.props.summary.estimatedTime>0&&(t=[React.createElement("dt",null,"Duration:"),React.createElement("dd",null,this.props.summary.estimatedTime," min approx.")]);var n=a.classNames({activated:this.props.activated,"quick-summary":!0}),r=null;if("undefined"!=typeof this.props.context.deployHelp&&this.props.context.deployHelp&&(r=React.createElement("a",{target:"_blank",className:"small",href:this.props.context.deployHelp},"more info")),this.props.context.siteUrl)var s=React.createElement("a",{target:"_blank",href:this.props.context.siteUrl},this.props.context.envName);else var s=React.createElement("span",null,this.props.context.envName);return React.createElement("dl",{className:n},React.createElement("dt",null,"Environment:"),React.createElement("dd",null,s),React.createElement("dt",null,"Deploy type:"),React.createElement("dd",null,e," ",r),t)}}),o=React.createClass({displayName:"MessageList",render:function(){if(this.props.messages.length<1)return null;if("undefined"==typeof this.props.messages)return null;var e=0,t=this.props.messages.map(function(t){return e++,React.createElement(l,{key:e,message:t})});return React.createElement("div",null,t)}}),l=React.createClass({displayName:"Message",render:function(){var e={error:"alert alert-danger",warning:"alert alert-warning",success:"alert alert-info"},t=e[this.props.message.code];return React.createElement("div",{className:t,role:"alert",dangerouslySetInnerHTML:{__html:this.props.message.text}})}});t.exports=i},{"./events.js":6,"./helpers.js":7,"./summary_table.jsx":8}],5:[function(e,t,n){var r=e("./events.js"),a=e("./helpers.js"),s=e("./deploy_plan.jsx"),i=React.createClass({displayName:"DeploymentDialog",loadingSub:null,loadingDoneSub:null,errorSub:null,getInitialState:function(){return{loading:!1,loadingText:"",errorText:"",fetched:!0,last_fetched:""}},componentDidMount:function(){var e=this;this.loadingSub=r.subscribe("loading",function(t){e.setState({loading:!0,success:!1,loadingText:t})}),this.loadingDoneSub=r.subscribe("loading/done",function(){e.setState({loading:!1,loadingText:"",success:!0})}),this.errorSub=r.subscribe("error",function(t){e.setState({errorText:t,loading:!1,loadingText:"",success:!1})})},componentWillUnmount:function(){this.loadingSub.remove(),this.loadingDoneSub.remove(),this.errorSub.remove()},handleClick:function(e){e.preventDefault(),r.publish("loading","Fetching latest code…"),this.setState({fetched:!1});var t=this;Q($.ajax({type:"POST",dataType:"json",url:this.props.context.projectUrl+"/fetch"})).then(this.waitForFetchToComplete,this.fetchStatusError).then(function(){r.publish("loading/done"),t.setState({fetched:!0})})["catch"](this.fetchStatusError).done()},waitForFetchToComplete:function(e){var t=this;return this.getFetchStatus(e).then(function(n){return"Complete"===n.status?n:"Failed"===n.status?$.Deferred(function(e){return e.reject(n)}).promise():t.waitForFetchToComplete(e)})},getFetchStatus:function(e){return Q($.ajax({type:"GET",url:e.href,dataType:"json"}))},fetchStatusError:function(e){var t="Unknown error";"undefined"!=typeof e.responseText?t=e.responseText:"undefined"!=typeof e.message&&(t=e.message),r.publish("error",t)},lastFetchedHandler:function(e){this.setState({last_fetched:e})},render:function(){var e,t=a.classNames({"deploy-dropdown":!0,loading:this.state.loading,success:this.state.success});return""!==this.state.errorText?e=React.createElement(o,{message:this.state.errorText}):this.state.fetched?e=React.createElement(u,{context:this.props.context,data:this.props.data,lastFetchedHandler:this.lastFetchedHandler}):this.state.loading&&(e=React.createElement(c,{message:"Fetching latest code…"})),React.createElement("div",null,React.createElement("div",{className:t,onClick:this.handleClick},React.createElement("span",{className:"status-icon","aria-hidden":"true"}),React.createElement("span",{className:"time"},"last updated ",this.state.last_fetched),React.createElement(l,{environmentName:this.props.context.envName})),e)}}),c=React.createClass({displayName:"LoadingDeployForm",render:function(){return React.createElement("div",{className:"deploy-form-loading"},React.createElement("div",{className:"icon-holder"},React.createElement("i",{className:"fa fa-cog fa-spin"}),React.createElement("span",null,this.props.message)))}}),o=React.createClass({displayName:"ErrorMessages",render:function(){return React.createElement("div",{className:"deploy-dropdown-errors"},this.props.message)}}),l=React.createClass({displayName:"EnvironmentName",render:function(){return React.createElement("span",{className:"environment-name"},React.createElement("i",{className:"fa fa-rocket"}," "),"Deployment options ",React.createElement("span",{className:"hidden-xs"},"for ",this.props.environmentName))}}),u=React.createClass({displayName:"DeployForm",getInitialState:function(){return{selectedTab:1,data:[]}},componentDidMount:function(){this.gitData()},gitData:function(){var e=this;e.setState({loading:!0}),Q($.ajax({type:"POST",dataType:"json",url:this.props.context.envUrl+"/git_revisions"})).then(function(t){e.setState({loading:!1,data:t.Tabs}),e.props.lastFetchedHandler(t.last_fetched)},function(e){r.publish("error",e)})},selectHandler:function(e){this.setState({selectedTab:e})},render:function(){return this.state.loading?React.createElement(c,{message:"Loading…"}):React.createElement("div",{className:"deploy-form-outer clearfix"},React.createElement("form",{className:"form-inline deploy-form",action:"POST",action:"#"},React.createElement(p,{data:this.state.data,onSelect:this.selectHandler,selectedTab:this.state.selectedTab}),React.createElement(d,{context:this.props.context,data:this.state.data,selectedTab:this.state.selectedTab,SecurityToken:this.state.SecurityToken})))}}),p=React.createClass({displayName:"DeployTabSelector",render:function(){var e=this,t=this.props.data.map(function(t){return React.createElement(f,{key:t.id,tab:t,onSelect:e.props.onSelect,selectedTab:e.props.selectedTab})});return React.createElement("ul",{className:"SelectionGroup tabbedselectiongroup nolabel"},t)}}),f=React.createClass({displayName:"DeployTabSelect",handleClick:function(e){e.preventDefault(),this.props.onSelect(this.props.tab.id)},render:function(){var e=a.classNames({active:this.props.selectedTab==this.props.tab.id});return React.createElement("li",{className:e},React.createElement("a",{onClick:this.handleClick,href:"#deploy-tab-"+this.props.tab.id},this.props.tab.name))}}),d=React.createClass({displayName:"DeployTabs",render:function(){var e=this,t=this.props.data.map(function(t){return React.createElement(m,{context:e.props.context,key:t.id,tab:t,selectedTab:e.props.selectedTab,SecurityToken:e.props.SecurityToken})});return React.createElement("div",{className:"tab-content"},t)}}),m=React.createClass({displayName:"DeployTab",getInitialState:function(){return{summary:this.getInitialSummaryState(),options:{},sha:""}},getInitialSummaryState:function(){return{changes:{},messages:[],validationCode:"",estimatedTime:null,actionCode:null,initialState:!0}},OptionChangeHandler:function(e){var t=this.state.options;t[e.target.name]=e.target.checked,this.setState({options:t})},SHAChangeHandler:function(e){this.setState({sha:e.target.value})},changeHandler:function(e){if(e.preventDefault(),this.setState({summary:this.getInitialSummaryState()}),""!==e.target.value){r.publish("change_loading");var t={sha:React.findDOMNode(this.refs.sha_selector.refs.sha).value,SecurityID:this.props.SecurityToken};for(var n in this.state.options)this.state.options.hasOwnProperty(n)&&(t[n]=this.state.options[n]);Q($.ajax({type:"POST",dataType:"json",url:this.props.context.envUrl+"/deploy_summary",data:t})).then(function(e){this.setState({summary:e}),r.publish("change_loading/done")}.bind(this),function(){r.publish("change_loading/done")})}},showOptions:function(){return"true"===this.props.tab.advanced_opts},showVerifyButton:function(){return this.showOptions()?!0:"textfield"==this.props.tab.field_type},shaChosen:function(){return""!==this.state.sha},render:function(){var e,t=a.classNames({"tab-pane":!0,clearfix:!0,active:this.props.selectedTab==this.props.tab.id});if("dropdown"==this.props.tab.field_type){var n=this.changeHandler;this.showVerifyButton()&&(n=this.SHAChangeHandler),e=React.createElement(h,{ref:"sha_selector",tab:this.props.tab,changeHandler:n})}else"textfield"==this.props.tab.field_type&&(e=React.createElement(y,{ref:"sha_selector",tab:this.props.tab,changeHandler:this.SHAChangeHandler}));var r=null;this.showOptions()&&(r=React.createElement(v,{tab:this.props.tab,changeHandler:this.OptionChangeHandler}));var i=null;return this.showVerifyButton()&&(i=React.createElement(g,{disabled:!this.shaChosen(),changeHandler:this.changeHandler})),React.createElement("div",{id:"deploy-tab-"+this.props.tab.id,className:t},React.createElement("div",{className:"section"},React.createElement("div",{htmlFor:this.props.tab.field_id,className:"header"},React.createElement("span",{className:"numberCircle"},"1")," ",this.props.tab.field_label),e,r,i),React.createElement(s,{context:this.props.context,summary:this.state.summary}))}}),h=React.createClass({displayName:"SelectorDropdown",componentDidMount:function(){$(React.findDOMNode(this.refs.sha)).select2({data:this.props.tab.field_data}),this.props.changeHandler&&$(React.findDOMNode(this.refs.sha)).select2().on("change",this.props.changeHandler)},render:function(){var e={width:"100%"};return React.createElement("div",null,React.createElement("div",{className:"field"},React.createElement("select",{ref:"sha",id:this.props.tab.field_id,name:"sha",className:"dropdown",onChange:this.props.changeHandler,style:e},React.createElement("option",{value:""},"Select ",this.props.tab.field_id))))}}),y=React.createClass({displayName:"SelectorText",render:function(){return React.createElement("div",{className:"field"},React.createElement("input",{type:"text",ref:"sha",id:this.props.tab.field_id,name:"sha",className:"text",onChange:this.props.changeHandler}))}}),g=React.createClass({displayName:"VerifyButton",render:function(){return React.createElement("div",{className:""},React.createElement("button",{disabled:this.props.disabled,value:"Verify deployment",className:"btn btn-default",onClick:this.props.changeHandler},"Verify deployment"))}}),v=React.createClass({displayName:"AdvancedOptions",render:function(){return React.createElement("div",{className:"deploy-options"},React.createElement("div",{className:"fieldcheckbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",name:"force_full",onChange:this.props.changeHandler}),"Force full deployment")))}});t.exports=i},{"./deploy_plan.jsx":4,"./events.js":6,"./helpers.js":7}],6:[function(e,t,n){var r={},a=r.hasOwnProperty;t.exports={subscribe:function(e,t){a.call(r,e)||(r[e]=[]);var n=r[e].push(t)-1;return{remove:function(){delete r[e][n]}}},publish:function(e,t){a.call(r,e)&&r[e].forEach(function(e){e(void 0!=t?t:{})})}}},{}],7:[function(e,t,n){t.exports={classNames:function(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];if(n){var r=typeof n;if("string"===r||"number"===r)e+=" "+n;else if(Array.isArray(n))e+=" "+classNames.apply(null,n);else if("object"===r)for(var a in n)n.hasOwnProperty(a)&&n[a]&&(e+=" "+a)}}return e.substr(1)}}},{}],8:[function(e,t,n){var r=React.createClass({displayName:"SummaryTable",isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0},render:function(){var e=this.props.changes;if(this.isEmpty(e))return null;var t=0,n=Object.keys(e).map(function(n){t++;var r=null;return"undefined"!=typeof e[n].compareUrl&&(r=e[n].compareUrl),"undefined"!=typeof e[n].description?""!==e[n].description?React.createElement(i,{key:t,name:n,description:e[n].description}):React.createElement(s,{key:t,name:n,value:""}):e[n].from!=e[n].to?React.createElement(a,{key:t,name:n,from:e[n].from,to:e[n].to,compareUrl:r}):React.createElement(s,{key:t,name:n,value:e[n].from})});return React.createElement("table",{className:"table table-striped table-hover"},React.createElement("tbody",null,n))}}),a=React.createClass({displayName:"SummaryLine",render:function(){var e=this.props.from,t=this.props.to;null!==e&&40===e.length&&(e=e.substring(0,7)),null!==t&&40===t.length&&(t=t.substring(0,7));var n=null;return null!==this.props.compareUrl&&(n=React.createElement("a",{target:"_blank",href:this.props.compareUrl},"View diff")),React.createElement("tr",null,React.createElement("th",{scope:"row"},this.props.name),React.createElement("td",null,e),React.createElement("td",null,React.createElement("span",{className:"glyphicon glyphicon-arrow-right"})),React.createElement("td",null,t),React.createElement("td",{className:"changeAction"},n))}}),s=React.createClass({displayName:"UnchangedSummaryLine",render:function(){var e=this.props.value;return null!==e&&40===e.length&&(e=e.substring(0,7)),React.createElement("tr",null,React.createElement("th",{scope:"row"},this.props.name),React.createElement("td",null,e),React.createElement("td",null," "),React.createElement("td",null,React.createElement("span",{className:"label label-success"},"Unchanged")),React.createElement("td",null," "))}}),i=React.createClass({displayName:"DescriptionOnlySummaryLine",render:function(){return React.createElement("tr",null,React.createElement("th",{scope:"row"},this.props.name),React.createElement("td",{colSpan:"4",dangerouslySetInnerHTML:{__html:this.props.description}}))}});t.exports=r},{}],9:[function(e,t,n){(function(){function e(e){function t(t,n,r,a,s,i){for(;s>=0&&i>s;s+=e){var c=a?a[s]:s;r=n(r,t[c],c,t)}return r}return function(n,r,a,s){r=E(r,s,4);var i=!T(n)&&R.keys(n),c=(i||n).length,o=e>0?0:c-1;return arguments.length<3&&(a=n[i?i[o]:o],o+=e),t(n,r,a,i,o,c)}}function r(e){return function(t,n,r){n=x(n,r);for(var a=k(t),s=e>0?0:a-1;s>=0&&a>s;s+=e)if(n(t[s],s,t))return s;return-1}}function a(e,t,n){return function(r,a,s){var i=0,c=k(r);if("number"==typeof s)e>0?i=s>=0?s:Math.max(s+c,i):c=s>=0?Math.min(s+1,c):s+c+1;else if(n&&s&&c)return s=n(r,a),r[s]===a?s:-1;if(a!==a)return s=t(f.call(r,i,c),R.isNaN),s>=0?s+i:-1;for(s=e>0?i:c-1;s>=0&&c>s;s+=e)if(r[s]===a)return s;return-1}}function s(e,t){var n=D.length,r=e.constructor,a=R.isFunction(r)&&r.prototype||l,s="constructor";for(R.has(e,s)&&!R.contains(t,s)&&t.push(s);n--;)s=D[n],s in e&&e[s]!==a[s]&&!R.contains(t,s)&&t.push(s)}var i=this,c=i._,o=Array.prototype,l=Object.prototype,u=Function.prototype,p=o.push,f=o.slice,d=l.toString,m=l.hasOwnProperty,h=Array.isArray,y=Object.keys,g=u.bind,v=Object.create,b=function(){},R=function(e){return e instanceof R?e:this instanceof R?void(this._wrapped=e):new R(e)};"undefined"!=typeof n?("undefined"!=typeof t&&t.exports&&(n=t.exports=R),n._=R):i._=R,R.VERSION="1.8.3";var E=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,a){return e.call(t,n,r,a)};case 4:return function(n,r,a,s){return e.call(t,n,r,a,s)}}return function(){return e.apply(t,arguments)}},x=function(e,t,n){return null==e?R.identity:R.isFunction(e)?E(e,t,n):R.isObject(e)?R.matcher(e):R.property(e)};R.iteratee=function(e,t){return x(e,t,1/0)};var N=function(e,t){return function(n){var r=arguments.length;if(2>r||null==n)return n;for(var a=1;r>a;a++)for(var s=arguments[a],i=e(s),c=i.length,o=0;c>o;o++){var l=i[o];t&&void 0!==n[l]||(n[l]=s[l])}return n}},S=function(e){if(!R.isObject(e))return{};if(v)return v(e);b.prototype=e;var t=new b;return b.prototype=null,t},_=function(e){return function(t){return null==t?void 0:t[e]}},w=Math.pow(2,53)-1,k=_("length"),T=function(e){var t=k(e);return"number"==typeof t&&t>=0&&w>=t};R.each=R.forEach=function(e,t,n){t=E(t,n);var r,a;if(T(e))for(r=0,a=e.length;a>r;r++)t(e[r],r,e);else{var s=R.keys(e);for(r=0,a=s.length;a>r;r++)t(e[s[r]],s[r],e)}return e},R.map=R.collect=function(e,t,n){t=x(t,n);for(var r=!T(e)&&R.keys(e),a=(r||e).length,s=Array(a),i=0;a>i;i++){var c=r?r[i]:i;s[i]=t(e[c],c,e)}return s},R.reduce=R.foldl=R.inject=e(1),R.reduceRight=R.foldr=e(-1),R.find=R.detect=function(e,t,n){var r;return r=T(e)?R.findIndex(e,t,n):R.findKey(e,t,n),void 0!==r&&-1!==r?e[r]:void 0},R.filter=R.select=function(e,t,n){var r=[];return t=x(t,n),R.each(e,function(e,n,a){t(e,n,a)&&r.push(e)}),r},R.reject=function(e,t,n){return R.filter(e,R.negate(x(t)),n)},R.every=R.all=function(e,t,n){t=x(t,n);for(var r=!T(e)&&R.keys(e),a=(r||e).length,s=0;a>s;s++){var i=r?r[s]:s;if(!t(e[i],i,e))return!1}return!0},R.some=R.any=function(e,t,n){t=x(t,n);for(var r=!T(e)&&R.keys(e),a=(r||e).length,s=0;a>s;s++){var i=r?r[s]:s;if(t(e[i],i,e))return!0}return!1},R.contains=R.includes=R.include=function(e,t,n,r){return T(e)||(e=R.values(e)),("number"!=typeof n||r)&&(n=0),R.indexOf(e,t,n)>=0},R.invoke=function(e,t){var n=f.call(arguments,2),r=R.isFunction(t);return R.map(e,function(e){var a=r?t:e[t];return null==a?a:a.apply(e,n)})},R.pluck=function(e,t){return R.map(e,R.property(t))},R.where=function(e,t){return R.filter(e,R.matcher(t))},R.findWhere=function(e,t){return R.find(e,R.matcher(t))},R.max=function(e,t,n){var r,a,s=-(1/0),i=-(1/0);if(null==t&&null!=e){e=T(e)?e:R.values(e);for(var c=0,o=e.length;o>c;c++)r=e[c],r>s&&(s=r)}else t=x(t,n),R.each(e,function(e,n,r){a=t(e,n,r),(a>i||a===-(1/0)&&s===-(1/0))&&(s=e,i=a)});return s},R.min=function(e,t,n){var r,a,s=1/0,i=1/0;if(null==t&&null!=e){e=T(e)?e:R.values(e);for(var c=0,o=e.length;o>c;c++)r=e[c],s>r&&(s=r)}else t=x(t,n),R.each(e,function(e,n,r){a=t(e,n,r),(i>a||a===1/0&&s===1/0)&&(s=e,i=a)});return s},R.shuffle=function(e){for(var t,n=T(e)?e:R.values(e),r=n.length,a=Array(r),s=0;r>s;s++)t=R.random(0,s),t!==s&&(a[s]=a[t]),a[t]=n[s];return a},R.sample=function(e,t,n){return null==t||n?(T(e)||(e=R.values(e)),e[R.random(e.length-1)]):R.shuffle(e).slice(0,Math.max(0,t))},R.sortBy=function(e,t,n){return t=x(t,n),R.pluck(R.map(e,function(e,n,r){return{value:e,index:n,criteria:t(e,n,r)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return e.index-t.index}),"value")};var j=function(e){return function(t,n,r){var a={};return n=x(n,r),R.each(t,function(r,s){var i=n(r,s,t);e(a,r,i)}),a}};R.groupBy=j(function(e,t,n){R.has(e,n)?e[n].push(t):e[n]=[t]}),R.indexBy=j(function(e,t,n){e[n]=t}),R.countBy=j(function(e,t,n){R.has(e,n)?e[n]++:e[n]=1}),R.toArray=function(e){return e?R.isArray(e)?f.call(e):T(e)?R.map(e,R.identity):R.values(e):[]},R.size=function(e){return null==e?0:T(e)?e.length:R.keys(e).length},R.partition=function(e,t,n){t=x(t,n);var r=[],a=[];return R.each(e,function(e,n,s){(t(e,n,s)?r:a).push(e)}),[r,a]},R.first=R.head=R.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:R.initial(e,e.length-t)},R.initial=function(e,t,n){return f.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},R.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:R.rest(e,Math.max(0,e.length-t))},R.rest=R.tail=R.drop=function(e,t,n){return f.call(e,null==t||n?1:t)},R.compact=function(e){return R.filter(e,R.identity)};var C=function(e,t,n,r){for(var a=[],s=0,i=r||0,c=k(e);c>i;i++){var o=e[i];if(T(o)&&(R.isArray(o)||R.isArguments(o))){t||(o=C(o,t,n));var l=0,u=o.length;for(a.length+=u;u>l;)a[s++]=o[l++]}else n||(a[s++]=o)}return a};R.flatten=function(e,t){return C(e,t,!1)},R.without=function(e){return R.difference(e,f.call(arguments,1))},R.uniq=R.unique=function(e,t,n,r){R.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=x(n,r));for(var a=[],s=[],i=0,c=k(e);c>i;i++){var o=e[i],l=n?n(o,i,e):o;t?(i&&s===l||a.push(o),s=l):n?R.contains(s,l)||(s.push(l),a.push(o)):R.contains(a,o)||a.push(o)}return a},R.union=function(){return R.uniq(C(arguments,!0,!0))},R.intersection=function(e){for(var t=[],n=arguments.length,r=0,a=k(e);a>r;r++){var s=e[r];if(!R.contains(t,s)){for(var i=1;n>i&&R.contains(arguments[i],s);i++);i===n&&t.push(s)}}return t},R.difference=function(e){var t=C(arguments,!0,!0,1);return R.filter(e,function(e){return!R.contains(t,e)})},R.zip=function(){return R.unzip(arguments)},R.unzip=function(e){for(var t=e&&R.max(e,k).length||0,n=Array(t),r=0;t>r;r++)n[r]=R.pluck(e,r);return n},R.object=function(e,t){for(var n={},r=0,a=k(e);a>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},R.findIndex=r(1),R.findLastIndex=r(-1),R.sortedIndex=function(e,t,n,r){n=x(n,r,1);for(var a=n(t),s=0,i=k(e);i>s;){var c=Math.floor((s+i)/2);n(e[c])<a?s=c+1:i=c}return s},R.indexOf=a(1,R.findIndex,R.sortedIndex),R.lastIndexOf=a(-1,R.findLastIndex),R.range=function(e,t,n){null==t&&(t=e||0,e=0),n=n||1;for(var r=Math.max(Math.ceil((t-e)/n),0),a=Array(r),s=0;r>s;s++,e+=n)a[s]=e;return a};var A=function(e,t,n,r,a){if(!(r instanceof t))return e.apply(n,a);var s=S(e.prototype),i=e.apply(s,a);return R.isObject(i)?i:s};R.bind=function(e,t){if(g&&e.bind===g)return g.apply(e,f.call(arguments,1));if(!R.isFunction(e))throw new TypeError("Bind must be called on a function");var n=f.call(arguments,2),r=function(){return A(e,r,t,this,n.concat(f.call(arguments)))};return r},R.partial=function(e){var t=f.call(arguments,1),n=function(){for(var r=0,a=t.length,s=Array(a),i=0;a>i;i++)s[i]=t[i]===R?arguments[r++]:t[i];for(;r<arguments.length;)s.push(arguments[r++]);return A(e,n,this,this,s)};return n},R.bindAll=function(e){var t,n,r=arguments.length;if(1>=r)throw new Error("bindAll must be passed function names");for(t=1;r>t;t++)n=arguments[t],e[n]=R.bind(e[n],e);return e},R.memoize=function(e,t){var n=function(r){var a=n.cache,s=""+(t?t.apply(this,arguments):r);return R.has(a,s)||(a[s]=e.apply(this,arguments)),a[s]};return n.cache={},n},R.delay=function(e,t){var n=f.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},R.defer=R.partial(R.delay,R,1),R.throttle=function(e,t,n){var r,a,s,i=null,c=0;n||(n={});var o=function(){c=n.leading===!1?0:R.now(),i=null,s=e.apply(r,a),i||(r=a=null)};return function(){var l=R.now();c||n.leading!==!1||(c=l);var u=t-(l-c);return r=this,a=arguments,0>=u||u>t?(i&&(clearTimeout(i),i=null),c=l,s=e.apply(r,a),i||(r=a=null)):i||n.trailing===!1||(i=setTimeout(o,u)),s}},R.debounce=function(e,t,n){var r,a,s,i,c,o=function(){var l=R.now()-i;t>l&&l>=0?r=setTimeout(o,t-l):(r=null,n||(c=e.apply(s,a),r||(s=a=null)))};return function(){s=this,a=arguments,i=R.now();var l=n&&!r;return r||(r=setTimeout(o,t)),l&&(c=e.apply(s,a),s=a=null),c}},R.wrap=function(e,t){return R.partial(t,e)},R.negate=function(e){return function(){return!e.apply(this,arguments)}},R.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}},R.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0;
}},R.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),1>=e&&(t=null),n}},R.once=R.partial(R.before,2);var O=!{toString:null}.propertyIsEnumerable("toString"),D=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];R.keys=function(e){if(!R.isObject(e))return[];if(y)return y(e);var t=[];for(var n in e)R.has(e,n)&&t.push(n);return O&&s(e,t),t},R.allKeys=function(e){if(!R.isObject(e))return[];var t=[];for(var n in e)t.push(n);return O&&s(e,t),t},R.values=function(e){for(var t=R.keys(e),n=t.length,r=Array(n),a=0;n>a;a++)r[a]=e[t[a]];return r},R.mapObject=function(e,t,n){t=x(t,n);for(var r,a=R.keys(e),s=a.length,i={},c=0;s>c;c++)r=a[c],i[r]=t(e[r],r,e);return i},R.pairs=function(e){for(var t=R.keys(e),n=t.length,r=Array(n),a=0;n>a;a++)r[a]=[t[a],e[t[a]]];return r},R.invert=function(e){for(var t={},n=R.keys(e),r=0,a=n.length;a>r;r++)t[e[n[r]]]=n[r];return t},R.functions=R.methods=function(e){var t=[];for(var n in e)R.isFunction(e[n])&&t.push(n);return t.sort()},R.extend=N(R.allKeys),R.extendOwn=R.assign=N(R.keys),R.findKey=function(e,t,n){t=x(t,n);for(var r,a=R.keys(e),s=0,i=a.length;i>s;s++)if(r=a[s],t(e[r],r,e))return r},R.pick=function(e,t,n){var r,a,s={},i=e;if(null==i)return s;R.isFunction(t)?(a=R.allKeys(i),r=E(t,n)):(a=C(arguments,!1,!1,1),r=function(e,t,n){return t in n},i=Object(i));for(var c=0,o=a.length;o>c;c++){var l=a[c],u=i[l];r(u,l,i)&&(s[l]=u)}return s},R.omit=function(e,t,n){if(R.isFunction(t))t=R.negate(t);else{var r=R.map(C(arguments,!1,!1,1),String);t=function(e,t){return!R.contains(r,t)}}return R.pick(e,t,n)},R.defaults=N(R.allKeys,!0),R.create=function(e,t){var n=S(e);return t&&R.extendOwn(n,t),n},R.clone=function(e){return R.isObject(e)?R.isArray(e)?e.slice():R.extend({},e):e},R.tap=function(e,t){return t(e),e},R.isMatch=function(e,t){var n=R.keys(t),r=n.length;if(null==e)return!r;for(var a=Object(e),s=0;r>s;s++){var i=n[s];if(t[i]!==a[i]||!(i in a))return!1}return!0};var H=function(e,t,n,r){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof R&&(e=e._wrapped),t instanceof R&&(t=t._wrapped);var a=d.call(e);if(a!==d.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var s="[object Array]"===a;if(!s){if("object"!=typeof e||"object"!=typeof t)return!1;var i=e.constructor,c=t.constructor;if(i!==c&&!(R.isFunction(i)&&i instanceof i&&R.isFunction(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],r=r||[];for(var o=n.length;o--;)if(n[o]===e)return r[o]===t;if(n.push(e),r.push(t),s){if(o=e.length,o!==t.length)return!1;for(;o--;)if(!H(e[o],t[o],n,r))return!1}else{var l,u=R.keys(e);if(o=u.length,R.keys(t).length!==o)return!1;for(;o--;)if(l=u[o],!R.has(t,l)||!H(e[l],t[l],n,r))return!1}return n.pop(),r.pop(),!0};R.isEqual=function(e,t){return H(e,t)},R.isEmpty=function(e){return null==e?!0:T(e)&&(R.isArray(e)||R.isString(e)||R.isArguments(e))?0===e.length:0===R.keys(e).length},R.isElement=function(e){return!(!e||1!==e.nodeType)},R.isArray=h||function(e){return"[object Array]"===d.call(e)},R.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},R.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){R["is"+e]=function(t){return d.call(t)==="[object "+e+"]"}}),R.isArguments(arguments)||(R.isArguments=function(e){return R.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(R.isFunction=function(e){return"function"==typeof e||!1}),R.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},R.isNaN=function(e){return R.isNumber(e)&&e!==+e},R.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===d.call(e)},R.isNull=function(e){return null===e},R.isUndefined=function(e){return void 0===e},R.has=function(e,t){return null!=e&&m.call(e,t)},R.noConflict=function(){return i._=c,this},R.identity=function(e){return e},R.constant=function(e){return function(){return e}},R.noop=function(){},R.property=_,R.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},R.matcher=R.matches=function(e){return e=R.extendOwn({},e),function(t){return R.isMatch(t,e)}},R.times=function(e,t,n){var r=Array(Math.max(0,e));t=E(t,n,1);for(var a=0;e>a;a++)r[a]=t(a);return r},R.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},R.now=Date.now||function(){return(new Date).getTime()};var I={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},F=R.invert(I),M=function(e){var t=function(t){return e[t]},n="(?:"+R.keys(e).join("|")+")",r=RegExp(n),a=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(a,t):e}};R.escape=M(I),R.unescape=M(F),R.result=function(e,t,n){var r=null==e?void 0:e[t];return void 0===r&&(r=n),R.isFunction(r)?r.call(e):r};var U=0;R.uniqueId=function(e){var t=++U+"";return e?e+t:t},R.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},K=/\\|'|\r|\n|\u2028|\u2029/g,L=function(e){return"\\"+B[e]};R.template=function(e,t,n){!t&&n&&(t=n),t=R.defaults({},t,R.templateSettings);var r=RegExp([(t.escape||P).source,(t.interpolate||P).source,(t.evaluate||P).source].join("|")+"|$","g"),a=0,s="__p+='";e.replace(r,function(t,n,r,i,c){return s+=e.slice(a,c).replace(K,L),a=c+t.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(s+="';\n"+i+"\n__p+='"),t}),s+="';\n",t.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var i=new Function(t.variable||"obj","_",s)}catch(c){throw c.source=s,c}var o=function(e){return i.call(this,e,R)},l=t.variable||"obj";return o.source="function("+l+"){\n"+s+"}",o},R.chain=function(e){var t=R(e);return t._chain=!0,t};var q=function(e,t){return e._chain?R(t).chain():t};R.mixin=function(e){R.each(R.functions(e),function(t){var n=R[t]=e[t];R.prototype[t]=function(){var e=[this._wrapped];return p.apply(e,arguments),q(this,n.apply(R,e))}})},R.mixin(R),R.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=o[e];R.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],q(this,n)}}),R.each(["concat","join","slice"],function(e){var t=o[e];R.prototype[e]=function(){return q(this,t.apply(this._wrapped,arguments))}}),R.prototype.value=function(){return this._wrapped},R.prototype.valueOf=R.prototype.toJSON=R.prototype.value,R.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return R})}).call(this)},{}]},{},[1]);