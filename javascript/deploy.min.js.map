{"version":3,"sources":["events.js","helpers.js","tablefilter.js","deploy.js"],"names":["events","topics","hOP","hasOwnProperty","subscribe","topic","listener","call","index","push","remove","publish","info","forEach","item","undefined","classNames","classes","i","arguments","length","arg","argType","Array","isArray","apply","key","substr","TableFilter","Arr","onInputEvent","evt","searchBox","target","tables","document","getElementsByClassName","getAttribute","table","tBodies","tbody","rows","filter","row","text","textContent","toLowerCase","val","value","style","display","indexOf","init","className","inputs","input","oninput","prototype","deploy","DeployDropDown","React","createClass","displayName","loadingSub","loadingDoneSub","errorSub","getInitialState","loading","loadingText","errorText","fetched","last_fetched","componentDidMount","self","this","setState","success","componentWillUnmount","handleClick","e","preventDefault","Q","$","ajax","type","dataType","url","props","context","projectUrl","then","waitForFetchToComplete","fetchStatusError","done","fetchData","getFetchStatus","data","status","Deferred","d","reject","promise","href","message","responseText","lastFetchedHandler","time_ago","render","form","deploy-dropdown","state","createElement","ErrorMessages","DeployForm","LoadingDeployForm","onClick","aria-hidden","EnvironmentName","environmentName","envName","selectedTab","gitData","envUrl","Tabs","selectHandler","id","action","DeployTabSelector","onSelect","DeployTabs","SecurityToken","selectors","map","tab","DeployTabSelect","active","name","tabs","DeployTab","summary","getInitialSummaryState","options","sha","changes","messages","validationCode","estimatedTime","actionCode","initialState","OptionChangeHandler","event","checked","SHAChangeHandler","changeHandler","summaryData","findDOMNode","refs","sha_selector","SecurityID","attrname","bind","showOptions","advanced_opts","shaChosen","selector","tab-pane","clearfix","field_type","SelectorDropdown","ref","SelectorText","AdvancedOptions","htmlFor","field_id","field_label","DeployPlan","select2","field_data","on","width","onChange","disabled","loading_changes","deploy_disabled","deployHover","deployHandler","strategy","window","location","console","error","mouseEnterHandler","mouseLeaveHandler","canDeploy","isEmpty","obj","showNoChangesMessage","actionTitle","code","deployAction","onMouseEnter","onMouseLeave","QuickSummary","activated","headerClasses","header","inactive","MessageList","SummaryTable","estimate","dlClasses","quick-summary","moreInfo","deployHelp","siteUrl","env","idx","Message","classMap","warning","classname","role","dangerouslySetInnerHTML","__html","summaryLines","Object","keys","compareUrl","from","to","SummaryLine","UnchangedSummaryLine","substring","scope","getElementById"],"mappings":"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","file":"deploy.min.js","sourcesContent":["var events = (function () {\n\n\n\t/**\n\t * A simple pub sub event handler for intercomponent communication\n\t *\n\t * @type {{subscribe, publish}}\n\t */\n\tvar events = (function(){\n\n\t\tvar topics = {};\n\n\t\tvar hOP = topics.hasOwnProperty;\n\n\t\treturn {\n\t\t\tsubscribe: function(topic, listener) {\n\t\t\t\t// Create the topic's object if not yet created\n\t\t\t\tif(!hOP.call(topics, topic)) topics[topic] = [];\n\n\t\t\t\t// Add the listener to queue\n\t\t\t\tvar index = topics[topic].push(listener) -1;\n\n\t\t\t\t// Provide handle back for removal of topic\n\t\t\t\treturn {\n\t\t\t\t\tremove: function() {\n\t\t\t\t\t\tdelete topics[topic][index];\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\t\t\tpublish: function(topic, info) {\n\t\t\t\t// If the topic doesn't exist, or there's no listeners in queue, just leave\n\t\t\t\tif(!hOP.call(topics, topic)) return;\n\n\t\t\t\t// Cycle through topics queue, fire!\n\t\t\t\ttopics[topic].forEach(function(item) {\n\t\t\t\t\titem(info != undefined ? info : {});\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t})();\n\n\treturn events;\n}());\n","/**\n * Helper class to concatinate strings depeding on a true or false.\n *\n * Example:\n * var classes = classNames({\n *     \"deploy-dropdown\": true,\n *     \"loading\": false,\n *     \"open\": true,\n * });\n *\n * then classes will equal \"deploy-dropdown open\"\n *\n * @returns {string}\n */\nvar classNames = (function () {\n\n\tfunction classNames () {\n\t\tvar classes = '';\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif ('string' === argType || 'number' === argType) {\n\t\t\t\tclasses += ' ' + arg;\n\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tclasses += ' ' + classNames.apply(null, arg);\n\n\t\t\t} else if ('object' === argType) {\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (arg.hasOwnProperty(key) && arg[key]) {\n\t\t\t\t\t\tclasses += ' ' + key;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn classes.substr(1);\n\t}\n\treturn classNames;\n}());\n","/**\n * Simple and basic html table filter\n *\n * Requires an <input> with <input class=\"table-filter\" data-table=\"table-to-filter\">\n * the input above refers to a <table class=\"table-to-filter\">\n *\n * Note that the table must have a tbody\n *\n * @type {{init}}\n */\nvar TableFilter = (function(Arr) {\n\n\tvar searchBox;\n\n\tfunction onInputEvent(evt) {\n\t\tsearchBox = evt.target;\n\t\t// find the table(s) to search\n\t\tvar tables = document.getElementsByClassName(searchBox.getAttribute('data-table'));\n\t\t// each table\n\t\tArr.forEach.call(tables, function(table) {\n\t\t\t// each body\n\t\t\tArr.forEach.call(table.tBodies, function(tbody) {\n\t\t\t\tArr.forEach.call(tbody.rows, filter);\n\t\t\t});\n\t\t});\n\t}\n\n\tfunction filter(row) {\n\t\tvar text = row.textContent.toLowerCase(), val = searchBox.value.toLowerCase();\n\t\trow.style.display = text.indexOf(val) === -1 ? 'none' : 'table-row';\n\t}\n\n\treturn {\n\t\tinit: function(className) {\n\t\t\tvar inputs = document.getElementsByClassName(className);\n\t\t\tArr.forEach.call(inputs, function(input) {\n\t\t\t\tinput.oninput = onInputEvent;\n\t\t\t});\n\t\t}\n\t};\n})(Array.prototype);\n","/** @jsx React.DOM */\n\nvar deploy = (function (events, classNames) {\n\t/**\n\t * DeployDropdown\n\t */\n\tvar DeployDropDown = React.createClass({displayName: \"DeployDropDown\",\n\n\t\tloadingSub: null,\n\n\t\tloadingDoneSub: null,\n\n\t\terrorSub: null,\n\n\t\tgetInitialState: function() {\n\t\t\treturn {\n\t\t\t\tloading: false,\n\t\t\t\tloadingText: \"\",\n\t\t\t\terrorText: \"\",\n\t\t\t\tfetched: true,\n\t\t\t\tlast_fetched: \"\"\n\t\t\t};\n\t\t},\n\t\tcomponentDidMount: function() {\n\t\t\tvar self = this;\n\t\t\t// add subscribers\n\t\t\tthis.loadingSub = events.subscribe('loading', function(text) {\n\t\t\t\tself.setState({\n\t\t\t\t\tloading: true,\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\tloadingText: text\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.loadingDoneSub = events.subscribe('loading/done', function() {\n\t\t\t\tself.setState({\n\t\t\t\t\tloading: false,\n\t\t\t\t\tloadingText: '',\n\t\t\t\t\tsuccess: true\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.errorSub = events.subscribe('error', function(text) {\n\t\t\t\tself.setState({\n\t\t\t\t\terrorText: text,\n\t\t\t\t\tloading: false,\n\t\t\t\t\tloadingText: '',\n\t\t\t\t\tsuccess: false\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tcomponentWillUnmount: function() {\n\t\t\t// remove subscribers\n\t\t\tthis.loadingSub.remove();\n\t\t\tthis.loadingDoneSub.remove();\n\t\t\tthis.errorSub.remove();\n\t\t},\n\t\thandleClick: function(e) {\n\t\t\te.preventDefault();\n\t\t\tevents.publish('loading', \"Fetching latest code…\");\n\t\t\tthis.setState({\n\t\t\t\tfetched: false\n\t\t\t});\n\t\t\tvar self = this;\n\t\t\tQ($.ajax({\n\t\t\t\ttype: \"POST\",\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: this.props.context.projectUrl + '/fetch'\n\t\t\t}))\n\t\t\t\t.then(this.waitForFetchToComplete, this.fetchStatusError)\n\t\t\t\t.then(function() {\n\t\t\t\t\tevents.publish('loading/done');\n\t\t\t\t\tself.setState({\n\t\t\t\t\t\tfetched: true\n\t\t\t\t\t})\n\t\t\t\t}).catch(this.fetchStatusError).done();\n\t\t},\n\t\twaitForFetchToComplete:function (fetchData) {\n\t\t\tvar self = this;\n\t\t\treturn this.getFetchStatus(fetchData).then(function (data) {\n\t\t\t\tif (data.status === \"Complete\") {\n\t\t\t\t\treturn data;\n\t\t\t\t}\n\t\t\t\tif (data.status === \"Failed\") {\n\t\t\t\t\treturn $.Deferred(function (d) {\n\t\t\t\t\t\treturn d.reject(data);\n\t\t\t\t\t}).promise();\n\t\t\t\t}\n\t\t\t\treturn self.waitForFetchToComplete(fetchData);\n\t\t\t});\n\t\t},\n\t\tgetFetchStatus: function (fetchData) {\n\t\t\treturn Q($.ajax({\n\t\t\t\ttype: \"GET\",\n\t\t\t\turl: fetchData.href,\n\t\t\t\tdataType: 'json'\n\t\t\t}));\n\t\t},\n\t\tfetchStatusError: function(data) {\n\t\t\tvar message  = 'Unknown error';\n\t\t\tif(typeof data.responseText !== 'undefined') {\n\t\t\t\tmessage = data.responseText;\n\t\t\t} else if (typeof data.message !== 'undefined') {\n\t\t\t\tmessage = data.message;\n\t\t\t}\n\t\t\tevents.publish('error', message);\n\t\t},\n\t\tlastFetchedHandler: function(time_ago) {\n\t\t\tthis.setState({last_fetched: time_ago});\n\t\t},\n\t\trender: function() {\n\t\t\tvar classes = classNames({\n\t\t\t\t\"deploy-dropdown\": true,\n\t\t\t\t\"loading\": this.state.loading,\n\t\t\t\t\"success\": this.state.success\n\t\t\t});\n\n\t\t\tvar form;\n\n\t\t\tif(this.state.errorText !== \"\") {\n\t\t\t\tform = React.createElement(ErrorMessages, {message: this.state.errorText})\n\t\t\t} else if(this.state.fetched) {\n\t\t\t\tform = React.createElement(DeployForm, {context: this.props.context, data: this.props.data, lastFetchedHandler: this.lastFetchedHandler})\n\t\t\t} else if (this.state.loading) {\n\t\t\t\tform = React.createElement(LoadingDeployForm, {message: \"Fetching latest code…\"})\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"div\", null, \n\t\t\t\t\tReact.createElement(\"div\", {className: classes, onClick: this.handleClick}, \n\t\t\t\t\t\tReact.createElement(\"span\", {className: \"status-icon\", \"aria-hidden\": \"true\"}), \n\t\t\t\t\t\tReact.createElement(\"span\", {className: \"time\"}, \"last updated \", this.state.last_fetched), \n\t\t\t\t\t\tReact.createElement(EnvironmentName, {environmentName: this.props.context.envName})\n\t\t\t\t\t), \n\t\t\t\t\tform\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t});\n\n\tvar LoadingDeployForm = React.createClass({displayName: \"LoadingDeployForm\",\n\t\trender: function() {\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"div\", {className: \"deploy-form-loading\"}, \n\t\t\t\t\tReact.createElement(\"div\", {className: \"icon-holder\"}, \n\t\t\t\t\t\tReact.createElement(\"i\", {className: \"fa fa-cog fa-spin\"}), \n\t\t\t\t\t\tReact.createElement(\"span\", null, this.props.message)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t});\n\n\tvar ErrorMessages = React.createClass({displayName: \"ErrorMessages\",\n\t\trender: function() {\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"div\", {className: \"deploy-dropdown-errors\"}, \n\t\t\t\t\tthis.props.message\n\t\t\t\t)\n\t\t\t)\n\t\t}\n\t});\n\n\t/**\n\t * EnvironmentName\n\t */\n\tvar EnvironmentName = React.createClass({displayName: \"EnvironmentName\",\n\t\trender: function () {\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"span\", {className: \"environment-name\"}, \n\t\t\t\t\tReact.createElement(\"i\", {className: \"fa fa-rocket\"}, \" \"), \n\t\t\t\t\t\"Deployment options \", React.createElement(\"span\", {className: \"hidden-xs\"}, \"for \", this.props.environmentName)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t});\n\n\t/**\n\t * DeployForm\n\t */\n\tvar DeployForm = React.createClass({displayName: \"DeployForm\",\n\t\tgetInitialState: function() {\n\t\t\treturn {\n\t\t\t\tselectedTab: 1,\n\t\t\t\tdata: []\n\t\t\t};\n\t\t},\n\t\tcomponentDidMount: function() {\n\t\t\tthis.gitData();\n\t\t},\n\n\t\tgitData: function() {\n\t\t\tvar self = this;\n\t\t\tself.setState({\n\t\t\t\tloading: true\n\t\t\t});\n\t\t\tQ($.ajax({\n\t\t\t\ttype: \"POST\",\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: this.props.context.envUrl + '/git_revisions'\n\t\t\t})).then(function(data) {\n\t\t\t\tself.setState({\n\t\t\t\t\tloading: false,\n\t\t\t\t\tdata: data.Tabs\n\t\t\t\t});\n\t\t\t\tself.props.lastFetchedHandler(data.last_fetched);\n\t\t\t}, function(data){\n\t\t\t\tevents.publish('error', data);\n\t\t\t});\n\t\t},\n\n\t\tselectHandler: function(id) {\n\t\t\tthis.setState({selectedTab: id});\n\t\t},\n\t\trender: function () {\n\t\t\tif(this.state.loading) {\n\t\t\t\treturn (\n\t\t\t\t\tReact.createElement(LoadingDeployForm, {message: \"Loading…\"})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"div\", {className: \"deploy-form-outer clearfix\"}, \n\t\t\t\t\tReact.createElement(\"form\", {className: \"form-inline deploy-form\", action: \"POST\", action: \"#\"}, \n\t\t\t\t\t\tReact.createElement(DeployTabSelector, {data: this.state.data, onSelect: this.selectHandler, selectedTab: this.state.selectedTab}), \n\t\t\t\t\t\tReact.createElement(DeployTabs, {context: this.props.context, data: this.state.data, selectedTab: this.state.selectedTab, SecurityToken: this.state.SecurityToken})\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t});\n\n\t/**\n\t * DeployTabSelector\n\t */\n\tvar DeployTabSelector = React.createClass({displayName: \"DeployTabSelector\",\n\t\trender: function () {\n\t\t\tvar self = this;\n\t\t\tvar selectors = this.props.data.map(function(tab) {\n\t\t\t\treturn (\n\t\t\t\t\tReact.createElement(DeployTabSelect, {key: tab.id, tab: tab, onSelect: self.props.onSelect, selectedTab: self.props.selectedTab})\n\t\t\t\t);\n\t\t\t});\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"ul\", {className: \"SelectionGroup tabbedselectiongroup nolabel\"}, \n\t\t\t\t\tselectors\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t});\n\n\t/**\n\t * DeployTabSelect\n\t */\n\tvar DeployTabSelect = React.createClass({displayName: \"DeployTabSelect\",\n\t\thandleClick: function(e) {\n\t\t\te.preventDefault();\n\t\t\tthis.props.onSelect(this.props.tab.id)\n\t\t},\n\t\trender: function () {\n\t\t\tvar classes = classNames({\n\t\t\t\t\"active\" : (this.props.selectedTab == this.props.tab.id)\n\t\t\t});\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"li\", {className: classes}, \n\t\t\t\t\tReact.createElement(\"a\", {onClick: this.handleClick, href: \"#deploy-tab-\"+this.props.tab.id}, this.props.tab.name)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t});\n\n\t/**\n\t * DeployTabs\n\t */\n\tvar DeployTabs = React.createClass({displayName: \"DeployTabs\",\n\t\trender: function () {\n\t\t\tvar self = this;\n\t\t\tvar tabs = this.props.data.map(function(tab) {\n\t\t\t\treturn (\n\t\t\t\t\tReact.createElement(DeployTab, {context: self.props.context, key: tab.id, tab: tab, selectedTab: self.props.selectedTab, SecurityToken: self.props.SecurityToken})\n\t\t\t\t);\n\t\t\t});\n\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"div\", {className: \"tab-content\"}, \n\t\t\t\t\ttabs\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t});\n\n\t/**\n\t * DeployTab\n\t */\n\tvar DeployTab = React.createClass({displayName: \"DeployTab\",\n\t\tgetInitialState: function() {\n\t\t\treturn {\n\t\t\t\tsummary: this.getInitialSummaryState(),\n\t\t\t\toptions: {},\n\t\t\t\tsha: ''\n\t\t\t};\n\t\t},\n\t\tgetInitialSummaryState: function() {\n\t\t\treturn {\n\t\t\t\tchanges: {},\n\t\t\t\tmessages: [],\n\t\t\t\tvalidationCode: '',\n\t\t\t\testimatedTime: null,\n\t\t\t\tactionCode: null,\n\t\t\t\tinitialState: true\n\t\t\t}\n\t\t},\n\t\tOptionChangeHandler: function(event) {\n\t\t\tvar options = this.state.options;\n\t\t\toptions[event.target.name] = event.target.checked;\n\t\t\tthis.setState({\n\t\t\t\toptions: options\n\t\t\t});\n\t\t},\n\t\tSHAChangeHandler: function(event) {\n\t\t\tthis.setState({\n\t\t\t\tsha: event.target.value\n\t\t\t});\n\t\t},\n\t\tchangeHandler: function(event) {\n\t\t\tevent.preventDefault();\n\n\t\t\tthis.setState({\n\t\t\t\tsummary: this.getInitialSummaryState()\n\t\t\t});\n\n\t\t\tif(event.target.value === \"\") {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevents.publish('change_loading');\n\n\t\t\tvar summaryData = {\n\t\t\t\tsha: React.findDOMNode(this.refs.sha_selector.refs.sha).value,\n\t\t\t\tSecurityID: this.props.SecurityToken\n\t\t\t};\n\t\t\t// merge the 'advanced' options if they are set\n\t\t\tfor (var attrname in this.state.options) {\n\t\t\t\tif(this.state.options.hasOwnProperty(attrname)) {\n\t\t\t\t\tsummaryData[attrname] = this.state.options[attrname];\n\t\t\t\t}\n\t\t\t}\n\t\t\tQ($.ajax({\n\t\t\t\ttype: \"POST\",\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: this.props.context.envUrl + '/deploy_summary',\n\t\t\t\tdata: summaryData\n\t\t\t})).then(function(data) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tsummary: data\n\t\t\t\t});\n\t\t\t\tevents.publish('change_loading/done');\n\t\t\t}.bind(this), function(){\n\t\t\t\tevents.publish('change_loading/done');\n\t\t\t});\n\t\t},\n\n\t\tshowOptions: function() {\n\t\t\treturn this.props.tab.advanced_opts === 'true';\n\t\t},\n\n\t\tshaChosen: function() {\n\t\t\treturn (this.state.sha !== '');\n\t\t},\n\n\t\trender: function () {\n\t\t\tvar classes = classNames({\n\t\t\t\t\"tab-pane\": true,\n\t\t\t\t\"clearfix\": true,\n\t\t\t\t\"active\" : (this.props.selectedTab == this.props.tab.id)\n\t\t\t});\n\n\t\t\t// setup the dropdown or the text input for selecting a SHA\n\t\t\tvar selector;\n\t\t\tif (this.props.tab.field_type == 'dropdown') {\n\t\t\t\tvar changeHandler = this.changeHandler;\n\t\t\t\tselector = React.createElement(SelectorDropdown, {ref: \"sha_selector\", tab: this.props.tab, changeHandler: changeHandler})\n\t\t\t} else if (this.props.tab.field_type == 'textfield') {\n\t\t\t\tselector = React.createElement(SelectorText, {ref: \"sha_selector\", tab: this.props.tab, changeHandler: this.SHAChangeHandler})\n\t\t\t}\n\n\t\t\t// 'Advanced' options\n\t\t\tvar options = null;\n\t\t\tif(this.showOptions()) {\n\t\t\t\toptions = React.createElement(AdvancedOptions, {tab: this.props.tab, changeHandler: this.OptionChangeHandler})\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"div\", {id: \"deploy-tab-\"+this.props.tab.id, className: classes}, \n\t\t\t\t\tReact.createElement(\"div\", {className: \"section\"}, \n\t\t\t\t\t\tReact.createElement(\"div\", {htmlFor: this.props.tab.field_id, className: \"header\"}, \n\t\t\t\t\t\t\tReact.createElement(\"span\", {className: \"numberCircle\"}, \"1\"), \" \", this.props.tab.field_label\n\t\t\t\t\t\t), \n\t\t\t\t\t\tselector, \n\t\t\t\t\t\toptions\n\t\t\t\t\t), \n\t\t\t\t\tReact.createElement(DeployPlan, {context: this.props.context, summary: this.state.summary})\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t});\n\n\tvar SelectorDropdown = React.createClass({displayName: \"SelectorDropdown\",\n\t\tcomponentDidMount: function() {\n\t\t\t$(React.findDOMNode(this.refs.sha)).select2({\n\t\t\t\t// Load data into the select2.\n\t\t\t\t// The format supports optgroups, and looks like this:\n\t\t\t\t// [{text: 'optgroup text', children: [{id: '<sha>', text: '<inner text>'}]}]\n\t\t\t\tdata: this.props.tab.field_data\n\t\t\t});\n\n\t\t\t// Trigger handler only needed if there is no explicit button.\n\t\t\tif(this.props.changeHandler) {\n\t\t\t\t$(React.findDOMNode(this.refs.sha)).select2().on(\"change\", this.props.changeHandler);\n\t\t\t}\n\t\t},\n\n\t\trender: function() {\n\t\t\t// From https://select2.github.io/examples.html \"The best way to ensure that Select2 is using a percent based\n\t\t\t// width is to inline the style declaration into the tag\".\n\t\t\tvar style = {width: '100%'};\n\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"div\", null, \n\t\t\t\t\tReact.createElement(\"div\", {className: \"field\"}, \n\t\t\t\t\t\tReact.createElement(\"select\", {\n\t\t\t\t\t\t\tref: \"sha\", \n\t\t\t\t\t\t\tid: this.props.tab.field_id, \n\t\t\t\t\t\t\tname: \"sha\", \n\t\t\t\t\t\t\tclassName: \"dropdown\", \n\t\t\t\t\t\t\tonChange: this.props.changeHandler, \n\t\t\t\t\t\t\tstyle: style}, \n\t\t\t\t\t\t\tReact.createElement(\"option\", {value: \"\"}, \"Select \", this.props.tab.field_id)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t});\n\n\tvar SelectorText = React.createClass({displayName: \"SelectorText\",\n\t\trender: function() {\n\t\t\treturn(\n\t\t\t\tReact.createElement(\"div\", {className: \"field\"}, \n\t\t\t\t\tReact.createElement(\"input\", {\n\t\t\t\t\t\ttype: \"text\", \n\t\t\t\t\t\tref: \"sha\", \n\t\t\t\t\t\tid: this.props.tab.field_id, \n\t\t\t\t\t\tname: \"sha\", \n\t\t\t\t\t\tclassName: \"text\", \n\t\t\t\t\t\tonChange: this.props.changeHandler}\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t});\n\n\tvar VerifyButton = React.createClass({displayName: \"VerifyButton\",\n\t\trender: function() {\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"div\", {className: \"\"}, \n\t\t\t\t\tReact.createElement(\"button\", {\n\t\t\t\t\t\tdisabled: this.props.disabled, \n\t\t\t\t\t\tvalue: \"Verify deployment\", \n\t\t\t\t\t\tclassName: \"btn btn-default\", \n\t\t\t\t\t\tonClick: this.props.changeHandler}, \n\t\t\t\t\t\t\"Verify deployment\"\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t});\n\n\tvar AdvancedOptions = React.createClass({displayName: \"AdvancedOptions\",\n\t\trender: function () {\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"div\", {className: \"deploy-options\"}, \n\t\t\t\t\tReact.createElement(\"div\", {className: \"fieldcheckbox\"}, \n\t\t\t\t\t\tReact.createElement(\"label\", null, \n\t\t\t\t\t\t\tReact.createElement(\"input\", {\n\t\t\t\t\t\t\t\ttype: \"checkbox\", \n\t\t\t\t\t\t\t\tname: \"force_full\", \n\t\t\t\t\t\t\t\tonChange: this.props.changeHandler}\n\t\t\t\t\t\t\t), \n\t\t\t\t\t\t\t\"Force full deployment\"\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t});\n\n\t/**\n\t * DeployPlan\n\t */\n\tvar DeployPlan = React.createClass({displayName: \"DeployPlan\",\n\t\tloadingSub: null,\n\t\tloadingDoneSub: null,\n\t\tgetInitialState: function() {\n\t\t\treturn {\n\t\t\t\tloading_changes: false,\n\t\t\t\tdeploy_disabled: false,\n\t\t\t\tdeployHover: false\n\t\t\t}\n\t\t},\n\t\tcomponentDidMount: function() {\n\t\t\tvar self = this;\n\t\t\t// register subscribers\n\t\t\tthis.loadingSub = events.subscribe('change_loading', function () {\n\t\t\t\tself.setState({\n\t\t\t\t\tloading_changes: true\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.loadingDoneSub = events.subscribe('change_loading/done', function () {\n\t\t\t\tself.setState({\n\t\t\t\t\tloading_changes: false\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tdeployHandler: function(event) {\n\t\t\tevent.preventDefault();\n\t\t\tthis.setState({\n\t\t\t\tdeploy_disabled: true\n\t\t\t});\n\n\t\t\tQ($.ajax({\n\t\t\t\ttype: \"POST\",\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: this.props.context.envUrl + '/start-deploy',\n\t\t\t\tdata: {\n\t\t\t\t\t// Pass the strategy object the user has just signed off back to the backend.\n\t\t\t\t\t'strategy': this.props.summary,\n\t\t\t\t\t'SecurityID': this.props.summary.SecurityID\n\t\t\t\t}\n\t\t\t})).then(function(data) {\n\t\t\t\twindow.location = data.url;\n\t\t\t}, function(data){\n\t\t\t\tconsole.error(data);\n\t\t\t});\n\t\t},\n\t\tmouseEnterHandler: function(event) {\n\t\t\tthis.setState({deployHover: true});\n\t\t},\n\t\tmouseLeaveHandler: function(event) {\n\t\t\tthis.setState({deployHover: false});\n\t\t},\n\t\tcanDeploy: function() {\n\t\t\treturn (this.props.summary.validationCode===\"success\" || this.props.summary.validationCode===\"warning\");\n\t\t},\n\t\tisEmpty: function(obj) {\n\t\t\tfor (var key in obj) {\n\t\t\t\tif (obj.hasOwnProperty(key) && obj[key]) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\tshowNoChangesMessage: function() {\n\t\t\tvar summary = this.props.summary;\n\t\t\tif(summary.initialState === true) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif(summary.messages === 'undefined') {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn (this.isEmpty(summary.changes) && summary.messages.length === 0);\n\t\t},\n\t\tactionTitle: function() {\n\t\t\tvar actionTitle = this.props.summary.actionTitle;\n\t\t\tif (typeof actionTitle === 'undefined' || actionTitle === '' ) {\n\t\t\t\treturn 'Make a selection';\n\t\t\t}\n\t\t\treturn this.props.summary.actionTitle;\n\t\t},\n\t\trender: function() {\n\t\t\tvar messages = this.props.summary.messages;\n\t\t\tif (this.showNoChangesMessage()) {\n\t\t\t\tmessages = [{\n\t\t\t\t\ttext: \"There are no changes but you can deploy anyway if you wish.\",\n\t\t\t\t\tcode: \"success\"\n\t\t\t\t}];\n\t\t\t}\n\n\t\t\tvar deployAction;\n\t\t\tif(this.canDeploy()) {\n\t\t\t\tdeployAction = (\n\t\t\t\t\tReact.createElement(\"div\", {className: \"section\", \n\t\t\t\t\t\tonMouseEnter: this.mouseEnterHandler, \n\t\t\t\t\t\tonMouseLeave: this.mouseLeaveHandler}, \n\t\t\t\t\t\t\tReact.createElement(\"button\", {\n\t\t\t\t\t\t\t\tvalue: \"Confirm Deployment\", \n\t\t\t\t\t\t\t\tclassName: \"deploy pull-left\", \n\t\t\t\t\t\t\t\tdisabled: this.state.deploy_disabled, \n\t\t\t\t\t\t\t\tonClick: this.deployHandler}, \n\t\t\t\t\t\t\t\tthis.actionTitle()\n\t\t\t\t\t\t\t), \n\t\t\t\t\t\t\tReact.createElement(QuickSummary, {activated: this.state.deployHover, context: this.props.context, summary: this.props.summary})\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tvar headerClasses = classNames({\n\t\t\t\theader: true,\n\t\t\t\tinactive: !this.canDeploy(),\n\t\t\t\tloading: this.state.loading_changes\n\t\t\t});\n\n\t\t\treturn(\n\t\t\t\tReact.createElement(\"div\", null, \n\t\t\t\t\tReact.createElement(\"div\", {className: \"section\"}, \n\t\t\t\t\t\tReact.createElement(\"div\", {className: headerClasses}, \n\t\t\t\t\t\t\tReact.createElement(\"span\", {className: \"status-icon\"}), \n\t\t\t\t\t\t\tReact.createElement(\"span\", {className: \"numberCircle\"}, \"2\"), \" Review changes\"\n\t\t\t\t\t\t), \n\t\t\t\t\t\tReact.createElement(MessageList, {messages: messages}), \n\t\t\t\t\t\tReact.createElement(SummaryTable, {changes: this.props.summary.changes})\n\t\t\t\t\t), \n\t\t\t\t\tdeployAction\n\t\t\t\t)\n\t\t\t)\n\t\t}\n\t});\n\n\tvar QuickSummary = React.createClass({displayName: \"QuickSummary\",\n\t\trender: function() {\n\t\t\tvar type = (this.props.summary.actionCode==='fast' ? 'code-only' : 'full');\n\t\t\tvar estimate = [];\n\t\t\tif (this.props.summary.estimatedTime && this.props.summary.estimatedTime>0) {\n\t\t\t\testimate = [\n\t\t\t\t\tReact.createElement(\"dt\", null, \"Duration:\"),\n\t\t\t\t\tReact.createElement(\"dd\", null, this.props.summary.estimatedTime, \" min approx.\")\n\t\t\t\t];\n\t\t\t}\n\n\t\t\tvar dlClasses = classNames({\n\t\t\t\tactivated: this.props.activated,\n\t\t\t\t'quick-summary': true\n\t\t\t});\n\n\t\t\tvar moreInfo = null;\n\t\t\tif (typeof this.props.context.deployHelp!=='undefined' && this.props.context.deployHelp) {\n\t\t\t\tmoreInfo = (\n\t\t\t\t\tReact.createElement(\"a\", {target: \"_blank\", className: \"small\", href: this.props.context.deployHelp}, \"more info\")\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (this.props.context.siteUrl) {\n\t\t\t\tvar env = React.createElement(\"a\", {target: \"_blank\", href: this.props.context.siteUrl}, this.props.context.envName);\n\t\t\t} else {\n\t\t\t\tvar env = React.createElement(\"span\", null, this.props.context.envName);\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"dl\", {className: dlClasses}, \n\t\t\t\t\tReact.createElement(\"dt\", null, \"Environment:\"), \n\t\t\t\t\tReact.createElement(\"dd\", null, env), \n\t\t\t\t\tReact.createElement(\"dt\", null, \"Deploy type:\"), \n\t\t\t\t\tReact.createElement(\"dd\", null, type, \" \", moreInfo), \n\t\t\t\t\testimate\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t});\n\n\tvar MessageList = React.createClass({displayName: \"MessageList\",\n\t\trender: function() {\n\t\t\tif(this.props.messages.length < 1) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif(typeof this.props.messages === 'undefined') {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tvar idx = 0;\n\t\t\tvar messages = this.props.messages.map(function(message) {\n\t\t\t\tidx++;\n\t\t\t\treturn React.createElement(Message, {key: idx, message: message})\n\t\t\t});\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"div\", null, \n\t\t\t\t\tmessages\n\t\t\t\t)\n\t\t\t)\n\t\t}\n\t});\n\n\tvar Message = React.createClass({displayName: \"Message\",\n\t\trender: function() {\n\t\t\tvar classMap = {\n\t\t\t\t'error': 'alert alert-danger',\n\t\t\t\t'warning': 'alert alert-warning',\n\t\t\t\t'success': 'alert alert-info'\n\t\t\t};\n\t\t\tvar classname=classMap[this.props.message.code];\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"div\", {className: classname, role: \"alert\", \n\t\t\t\t\tdangerouslySetInnerHTML: {__html: this.props.message.text}})\n\t\t\t)\n\t\t}\n\t});\n\n\t/**\n\t * @jsx React.DOM\n\t */\n\tvar SummaryTable = React.createClass({displayName: \"SummaryTable\",\n\t\tisEmpty: function(obj) {\n\t\t\tfor (var key in obj) {\n\t\t\t\tif (obj.hasOwnProperty(key) && obj[key]) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\trender: function() {\n\t\t\tvar changes = this.props.changes;\n\t\t\tif(this.isEmpty(changes)) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tvar idx = 0;\n\t\t\tvar summaryLines = Object.keys(changes).map(function(key) {\n\t\t\t\tidx++;\n\n\t\t\t\tvar compareUrl = null;\n\t\t\t\tif(typeof changes[key].compareUrl != 'undefined') {\n\t\t\t\t\tcompareUrl = changes[key].compareUrl;\n\t\t\t\t}\n\n\t\t\t\tif(changes[key].from != changes[key].to) {\n\t\t\t\t\treturn React.createElement(SummaryLine, {key: idx, name: key, from: changes[key].from, to: changes[key].to, compareUrl: compareUrl})\n\t\t\t\t} else {\n\t\t\t\t\treturn React.createElement(UnchangedSummaryLine, {key: idx, name: key, value: changes[key].from})\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"table\", {className: \"table table-striped table-hover\"}, \n\t\t\t\t\tReact.createElement(\"thead\", null, \n\t\t\t\t\t\tReact.createElement(\"tr\", null, \n\t\t\t\t\t\t\tReact.createElement(\"th\", null, \" \"), \n\t\t\t\t\t\t\tReact.createElement(\"th\", null, \"From\"), \n\t\t\t\t\t\t\tReact.createElement(\"th\", null, \"To\"), \n\t\t\t\t\t\t\tReact.createElement(\"th\", {className: \"changeAction\"}, \" \")\n\t\t\t\t\t\t)\n\t\t\t\t\t), \n\t\t\t\t\tReact.createElement(\"tbody\", null, \n\t\t\t\t\t\tsummaryLines\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t});\n\n\t/**\n\t * SummaryLine\n\t */\n\tvar SummaryLine = React.createClass({displayName: \"SummaryLine\",\n\t\trender: function() {\n\t\t\tvar from = this.props.from,\n\t\t\t\tto = this.props.to;\n\n\t\t\t// naive git sha detection\n\t\t\tif(from !== null && from.length === 40) {\n\t\t\t\tfrom = from.substring(0,7);\n\t\t\t}\n\n\t\t\t// naive git sha detection\n\t\t\tif(to !== null && to.length === 40) {\n\t\t\t\tto = to.substring(0,7);\n\t\t\t}\n\n\t\t\tvar compareUrl = null;\n\t\t\tif(this.props.compareUrl !== null) {\n\t\t\t\tcompareUrl = React.createElement(\"a\", {target: \"_blank\", href: this.props.compareUrl}, \"View diff\")\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"tr\", null, \n\t\t\t\t\tReact.createElement(\"th\", {scope: \"row\"}, this.props.name), \n\t\t\t\t\tReact.createElement(\"td\", null, from), \n\t\t\t\t\tReact.createElement(\"td\", null, to), \n\t\t\t\t\tReact.createElement(\"td\", {className: \"changeAction\"}, compareUrl)\n\t\t\t\t)\n\t\t\t)\n\t\t}\n\t});\n\n\tvar UnchangedSummaryLine = React.createClass({displayName: \"UnchangedSummaryLine\",\n\t\trender: function() {\n\t\t\tvar from = this.props.value;\n\t\t\t// naive git sha detection\n\t\t\tif(from !== null && from.length === 40) {\n\t\t\t\tfrom = from.substring(0,7);\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\tReact.createElement(\"tr\", null, \n\t\t\t\t\tReact.createElement(\"th\", {scope: \"row\"}, this.props.name), \n\t\t\t\t\tReact.createElement(\"td\", null, from), \n\t\t\t\t\tReact.createElement(\"td\", null, \n\t\t\t\t\t\tReact.createElement(\"span\", {className: \"label label-success\"}, \"Unchanged\")\n\t\t\t\t\t), \n\t\t\t\t\tReact.createElement(\"td\", null, \" \")\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t});\n\n\treturn {\n\t\trender: function(context) {\n\t\t\tReact.render(\n\t\t\t\tReact.createElement(DeployDropDown, {\n\t\t\t\t\tcontext: context}),\n\t\t\t\tdocument.getElementById('deploy_form')\n\t\t\t);\n\t\t}\n\t}\n}(events, classNames));\n\nif (typeof context != 'undefined') {\n\tdeploy.render(context);\n}\n"],"sourceRoot":"/source/"}